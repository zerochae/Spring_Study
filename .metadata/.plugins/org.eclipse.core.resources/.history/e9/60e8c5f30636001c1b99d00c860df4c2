<%@page import="java.sql.DriverManager"%>
<%@page import="java.sql.SQLException"%>
<%@page import="java.sql.ResultSet"%>
<%@page import="java.sql.PreparedStatement"%>
<%@page import="java.sql.Connection"%>
<%@page import="java.util.Enumeration"%>
<%@page import="com.oreilly.servlet.multipart.DefaultFileRenamePolicy"%>
<%@page import="com.oreilly.servlet.MultipartRequest"%>
<%@ page language="java" contentType="text/html; charset=UTF-8" %>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %>
<!DOCTYPE html>

<%

	//cos.jar 사용하여 파일 처리
	
	String filename = "";
	String realFolder = "C:\\Users\\zeroc\\git\\JSP_Study\\JspServlet\\WebContent\\images";
	
	// 인코딩 타입
	String encType = "UTF-8";
	
	// 최대 업로드도리 파일의 크기 5MB
	int maxSize = 5 * 1024 * 1024;
	
	MultipartRequest multi = new MultipartRequest(request, realFolder, maxSize, encType, new DefaultFileRenamePolicy());
	
	String productId    = multi.getParameter("productId    ");
	String name         = multi.getParameter("name         ");
	String unitPrice    = multi.getParameter("unitPrice    ");
	String description  = multi.getParameter("description  ");
	String manufacturer = multi.getParameter("manufacturer ");
	String category     = multi.getParameter("category     ");
	String unitsInStock = multi.getParameter("unitsInStock ");
	String condition    = multi.getParameter("condition    ");
	
	
	// udpate 시 setInt() 메소드를 위해 int형으로 casting
	int price = Integer.parseInt(unitPrice);
	int stock = Integer.parseInt(unitsInStock);
	
	// 업로드가 완료된 첨부파일의 이름 정보 추출
	Enumeration files = multi.getFileNames();
	String fname = (String)files.nextElement();
	// 업로드된 파일의 실제 파일명을 가져옴
	String fileName = multi.getFilesystemName(fname);
	
	// Database 테이블로 update
		
		Connection conn = null;
		PreparedStatement pstmt = null;
		ResultSet rs = null;
		
		try{
			conn = DriverManager.getConnection("jdbc:apache:commons:dbcp:ddit");
			String sql = "select * from product where p_id = ?";
			pstmt = conn.prepareStatement(sql);
			pstmt.setString(1, productId);
			rs = pstmt.executeQuery();
		
			if(rs.next()){
				
			}
			

		
		} catch (SQLException e){
			
		}
		
		
%>


<html>
<head>
<title>Insert title here</title>
</head>
<body>

</body>
</html>